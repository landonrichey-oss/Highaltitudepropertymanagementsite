<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>High Altitude Property Management | Short-Term Rentals</title>
  <meta name="description"
    content="Short-term rentals near Park City & mountain getaways. Browse properties, view photos, and book online." />

  <!-- CSS -->
  <link rel="stylesheet" href="main.css" />
</head>

<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <!-- HEADER / NAVIGATION -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="#home">
        <span class="brand-mark" aria-hidden="true">üèîÔ∏è</span>
        <span class="brand-text">
          <strong>High Altitude Property Management</strong>
          <small>Short-Term Rentals</small>
        </span>
      </a>

      <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav">
        <span class="sr-only">Toggle menu</span>
        <span class="burger" aria-hidden="true"></span>
      </button>

      <nav id="site-nav" class="site-nav" aria-label="Primary">
        <a href="#home" class="nav-link" data-section="home">Home</a>
        <a href="#properties" class="nav-link" data-section="properties">Properties</a>
        <a href="#gallery" class="nav-link" data-section="gallery">Gallery</a>
        <a href="#contact" class="nav-link btn btn-small" data-section="contact">Contact</a>
      </nav>
    </div>
  </header>

  <main id="main">
    <!-- HOME / HERO SECTION -->
    <section id="home" class="section active-section">
      <!-- HERO -->
      <section class="hero">
        <div class="container hero-grid">
          <div class="hero-copy">
            <p class="eyebrow">Park City ‚Ä¢ Mountain Stays ‚Ä¢ Year-Round Adventures</p>
            <h1>Mountain getaways made easy.</h1>
            <p class="lead">
              Welcome to High Altitude Property Management ‚Äî curated short-term rentals near Park City.
              Explore the area, browse our properties, and book direct or via Airbnb/VRBO.
            </p>

            <div class="hero-actions">
              <a class="btn" href="#properties">Browse Properties</a>
              <a class="btn btn-ghost" href="#contact">Ask a Question</a>
            </div>

            <div class="trust-row" aria-label="Highlights">
              <div class="pill">‚≠ê Guest-ready</div>
              <div class="pill">üõÅ Hot tubs (select homes)</div>
              <div class="pill">üöó Close to town</div>
            </div>
          </div>

          <div class="hero-card" role="region" aria-label="Quick info">
            <div class="hero-card-media">
              <img src="assets/images/Fortuni.jpg" alt="Mountain stay" loading="eager" />
            </div>
            <div class="hero-card-body">
              <h2>Quick tip</h2>
              <p>Tap any gallery photo below to open full details.</p>
              <a class="btn btn-small" href="#gallery">View Gallery</a>
            </div>
          </div>
        </div>
      </section>

      <!-- WELCOME / AREA INFO -->
      <section class="section section-alt" id="welcome">
        <div class="container">
          <div class="section-head">
            <h2>Park City, Utah</h2>
            <p class="muted">
              World-class skiing, dining, shopping, and year-round mountain adventure ‚Äî all within easy reach.
            </p>
          </div>

          <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px;">
            <div class="card" style="padding:16px;">
              <h3>Winter</h3>
              <p class="muted">Skiing ‚Ä¢ Snowboarding ‚Ä¢ Snowmobiling ‚Ä¢ Sleigh rides ‚Ä¢ Cozy cabin nights</p>
            </div>

            <div class="card" style="padding:16px;">
              <h3>Summer</h3>
              <p class="muted">Hiking ‚Ä¢ Mountain biking ‚Ä¢ Lakes ‚Ä¢ Golf ‚Ä¢ Scenic drives ‚Ä¢ Festivals</p>
            </div>

            <div class="card" style="padding:16px;">
              <h3>Close to It All</h3>
              <p class="muted">Restaurants ‚Ä¢ Outlets ‚Ä¢ Woodward ‚Ä¢ Downtown Park City ‚Ä¢ Deer Valley</p>
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- PROPERTIES SECTION -->
    <section id="properties" class="section">
      <div class="container">
        <div class="section-head">
          <h2>Browse Properties</h2>
          <p class="muted">Select a property below ‚Äî the link updates automatically so it‚Äôs easy to share.</p>
        </div>

        <!-- Horizontal Property Selector -->
        <div class="picker-bar">
          <button id="pickerTitle" class="picker-title-btn" type="button" aria-label="Scroll properties">
            Properties
          </button>

          <div id="property-picker" class="property-picker" aria-label="Property list"></div>
        </div>

        <!-- Property detail renders here -->
        <div id="property-detail" class="property-detail"></div>
      </div>
    </section>

    <!-- GALLERY SECTION -->
    <section id="gallery" class="section">
      <div class="container">
        <div class="section-head">
          <h2>Gallery</h2>
          <p class="muted">Tap any photo to open the property details.</p>
        </div>

        <div class="gallery" id="gallery-grid"></div>

        <div style="margin-top:18px;">
          <a class="btn" href="#properties">Browse all properties</a>
        </div>
      </div>
    </section>

    <!-- CONTACT SECTION -->
    <section id="contact" class="section">
      <div class="container">
        <div class="contact-grid">
          <div>
            <h2>Contact</h2>
            <p class="muted">Questions about dates, access, or the right place for your group? Reach out.</p>

            <div class="contact-cards">
              <div class="contact-card">
                <div class="contact-icon" aria-hidden="true">üìû</div>
                <div>
                  <strong>Call / Text</strong><br />
                  <a href="tel:+13034089431">303-408-9431</a>
                </div>
              </div>

              <div class="contact-card">
                <div class="contact-icon" aria-hidden="true">‚úâÔ∏è</div>
                <div>
                  <strong>Email</strong><br />
                  <a href="mailto:hampparkcity@gmail.com">hampparkcity@gmail.com</a>
                </div>
              </div>
            </div>
          </div>

          <form class="form" id="contact-form">
            <label>
              Name
              <input name="name" required autocomplete="name" />
            </label>

            <label>
              Email
              <input name="email" type="email" required autocomplete="email" />
            </label>

            <label>
              Message
              <textarea name="message" rows="5" required
                placeholder="Dates, guest count, property questions, etc."></textarea>
            </label>

            <button class="btn" type="submit">Send message</button>
            <p class="form-status" id="form-status" aria-live="polite"></p>
          </form>
        </div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container footer-inner">
      <p>¬© <span id="year"></span> High Altitude Property Management. All rights reserved.</p>
      <div class="footer-links">
        <a href="#properties">Properties</a>
        <a href="#contact">Contact</a>
        <a href="#" id="back-to-top">Back to top ‚Üë</a>
      </div>
    </div>
  </footer>

  <!-- PROPERTY MODAL -->
  <div class="modal" id="property-modal" aria-hidden="true" role="dialog" aria-label="Property details">
    <div class="modal-backdrop" data-close="true"></div>

    <div class="modal-panel" role="document">
      <button class="modal-close" type="button" aria-label="Close" data-close="true">‚úï</button>

      <div class="modal-media">
        <!-- script.js replaces this with the slider -->
        <img id="modal-img" src="" alt="" />
      </div>

      <div class="modal-body">
        <h3 id="modal-title"></h3>
        <p class="muted" id="modal-subtitle"></p>
        <p id="modal-description"></p>

        <div class="amenities" id="modal-amenities" aria-label="Amenities"></div>
        <div class="modal-actions" id="modal-actions"></div>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script src="assets/js/properties-data.js"></script>
  <script src="assets/js/script.js" defer></script>

<!-- SECTION SWITCHING LOGIC -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const sections = document.querySelectorAll('.section');
    const navLinks = document.querySelectorAll('.nav-link, .brand');

    function showSection(sectionId) {
      sections.forEach(sec => {
        sec.classList.toggle('active-section', sec.id === sectionId);
      });

      document.getElementById(sectionId)?.scrollIntoView({ behavior: 'smooth', block: 'start' });

      // Re-render dynamic content
      if (sectionId === 'properties') {
        if (typeof renderPropertyPicker === 'function') {
          renderPropertyPicker();           // rebuild chips + auto-select from URL
        }
        loadPropertyFromUrl();              // ‚Üê important: apply ?property= param
      }
      if (sectionId === 'gallery') {
        if (typeof renderGalleryLinks === 'function') {
          renderGalleryLinks();
        }
      }
    }

    // NEW: Load specific property from ?property= param
    function loadPropertyFromUrl() {
      const params = new URLSearchParams(window.location.search);
      const slug = params.get("property")?.trim();

      if (!slug) return;

      const prop = properties.find(p => p.slug === slug) ||
        properties.find(p => p.slug.toLowerCase() === slug.toLowerCase());

      if (prop && typeof renderPropertyDetail === 'function') {
        // Make sure chips reflect the active one
        if (typeof setActiveChip === 'function') {
          setActiveChip(prop.slug);
        }
        renderPropertyDetail(prop);
        // Scroll to the detail area
        document.getElementById("property-detail")?.scrollIntoView({ behavior: "smooth" });
      }
    }

    // Click handler for nav links
    navLinks.forEach(link => {
      link.addEventListener('click', e => {
        const href = link.getAttribute('href');
        if (href?.startsWith('#')) {
          e.preventDefault();
          const target = href.substring(1);
          showSection(target);

          navLinks.forEach(l => l.classList.remove('active'));
          if (link.classList.contains('nav-link')) {
            link.classList.add('active');
          }
        }
      });
    });

    // Handle initial page load (hash + possible query param)
    let initialSection = 'home';
    if (location.hash) {
      initialSection = location.hash.substring(1).split('?')[0] || 'home';
    }
    showSection(initialSection);

    // If we landed directly on properties with a param, make sure detail loads
    if (initialSection === 'properties' || location.search.includes('property=')) {
      setTimeout(() => {
        loadPropertyFromUrl();
      }, 150); // slightly longer delay to ensure DOM + renderPropertyPicker has run
    }

    // Also listen for hash changes (browser back/forward or manual hash change)
    window.addEventListener('hashchange', () => {
      const newSection = location.hash.substring(1).split('?')[0] || 'home';
      showSection(newSection);
    });
  });
</script>

  <!-- Add this to main.css if not already present -->
  <style>
    .section {
      display: none;
    }

    .section.active-section {
      display: block;
    }

    .nav-link.active,
    .brand[href="#home"].active {
      font-weight: bold;
      color: 
        var(--color-primary);
      /* adjust to match your design */
    }
  </style>
</body>

</html>